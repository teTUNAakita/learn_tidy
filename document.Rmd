---
title: "document"
author: "T.A."
date: "2018/12/31"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## RstudioとGitHubの連携をしつつ、tidyverseの使い方の勉強

連携については、[ここ](https://qiita.com/uri/items/6b94609f156173ed43ed)を参考にしました。

## poulation dynamics

```{r, include=FALSE}
library(tidyverse)
```

```{r}
f <- function(x, r, K){
    r * x * (1 - x / K) + x
}

simulation <- function(r, K = 100, T = 100, x1 = 10){
  
  # Initialize
  x <- numeric(T)
  x[1] <- x1

  # Simulate
  for(t in 1:(T-1)){
    x[t+1] <- f(x = x[t], r, K)
  }
  
  data_frame(time = 1:T,  population = x)
}
simulation(r = 2.5)  %>%
  ggplot(aes(time, population)) + geom_line()
```
```{r}
data.frame(time = 1:5, pop = 50) %>% 
  mutate(pop = accumulate(pop, ~.x * 1.1))
```